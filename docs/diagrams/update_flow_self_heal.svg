<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: update_flow_self_heal Pages: 1 -->
<svg width="1274pt" height="1259pt"
 viewBox="0.00 0.00 1273.79 1258.82" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1254.82)">
<title>update_flow_self_heal</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1254.82 1269.79,-1254.82 1269.79,4 -4,4"/>
<text text-anchor="middle" x="632.9" y="-1230.82" font-family="Times,serif" font-size="20.00">Update Flow + Self&#45;Healing: User&#45;Supplied Path</text>
<!-- A -->
<g id="node1" class="node">
<title>A</title>
<ellipse fill="none" stroke="black" cx="525" cy="-1193.95" rx="106.55" ry="26.74"/>
<text text-anchor="middle" x="525" y="-1197.75" font-family="Times,serif" font-size="14.00">A: Path Input</text>
<text text-anchor="middle" x="525" y="-1182.75" font-family="Times,serif" font-size="14.00">(APF.PATH_INPUT)</text>
</g>
<!-- B -->
<g id="node2" class="node">
<title>B</title>
<polygon fill="none" stroke="black" points="651.5,-1130.08 398.5,-1130.08 398.5,-1092.08 651.5,-1092.08 651.5,-1130.08"/>
<text text-anchor="middle" x="525" y="-1114.88" font-family="Times,serif" font-size="14.00">B: Resolve &amp; Validate Path</text>
<text text-anchor="middle" x="525" y="-1099.88" font-family="Times,serif" font-size="14.00">(APF.PATH_RESOLVE_VALIDATE)</text>
</g>
<!-- A&#45;&gt;B -->
<g id="edge1" class="edge">
<title>A&#45;&gt;B</title>
<path fill="none" stroke="black" d="M525,-1166.91C525,-1158.38 525,-1148.86 525,-1140.18"/>
<polygon fill="black" stroke="black" points="528.5,-1140.13 525,-1130.13 521.5,-1140.13 528.5,-1140.13"/>
</g>
<!-- C -->
<g id="node3" class="node">
<title>C</title>
<polygon fill="none" stroke="black" points="527.5,-1041.08 354.5,-1041.08 354.5,-1003.08 527.5,-1003.08 527.5,-1041.08"/>
<text text-anchor="middle" x="441" y="-1025.88" font-family="Times,serif" font-size="14.00">C: Scan for Bundle</text>
<text text-anchor="middle" x="441" y="-1010.88" font-family="Times,serif" font-size="14.00">(APF.BUNDLE_SCAN)</text>
</g>
<!-- B&#45;&gt;C -->
<g id="edge2" class="edge">
<title>B&#45;&gt;C</title>
<path fill="none" stroke="black" d="M484.08,-1091.98C476.02,-1087.04 468.15,-1081.08 462,-1074.08 456.16,-1067.43 451.8,-1058.93 448.61,-1050.79"/>
<polygon fill="black" stroke="black" points="451.86,-1049.49 445.28,-1041.18 445.25,-1051.78 451.86,-1049.49"/>
<text text-anchor="middle" x="525.5" y="-1062.88" font-family="Times,serif" font-size="14.00">exists &amp; readable</text>
</g>
<!-- E -->
<g id="node12" class="node">
<title>E</title>
<polygon fill="none" stroke="black" points="766.05,-657.91 766.05,-682.07 670.54,-699.16 535.46,-699.16 439.95,-682.07 439.95,-657.91 535.46,-640.82 670.54,-640.82 766.05,-657.91"/>
<text text-anchor="middle" x="603" y="-673.79" font-family="Times,serif" font-size="14.00">E: Fail Fast â†’ error &amp; hints</text>
<text text-anchor="middle" x="603" y="-658.79" font-family="Times,serif" font-size="14.00">(APF.FAIL_FAST)</text>
</g>
<!-- B&#45;&gt;E -->
<g id="edge3" class="edge">
<title>B&#45;&gt;E</title>
<path fill="none" stroke="black" d="M568.23,-1092.02C576.02,-1087.15 583.43,-1081.21 589,-1074.08 603.47,-1055.55 603,-1046.58 603,-1023.08 603,-1023.08 603,-1023.08 603,-768.08 603,-748.77 603,-727.31 603,-709.49"/>
<polygon fill="black" stroke="black" points="606.5,-709.45 603,-699.45 599.5,-709.45 606.5,-709.45"/>
<text text-anchor="middle" x="657.5" y="-898.88" font-family="Times,serif" font-size="14.00">missing/denied</text>
</g>
<!-- D -->
<g id="node4" class="node">
<title>D</title>
<polygon fill="none" stroke="black" points="514.5,-966.08 311.5,-966.08 311.5,-928.08 514.5,-928.08 514.5,-966.08"/>
<text text-anchor="middle" x="413" y="-950.88" font-family="Times,serif" font-size="14.00">D: Bundle Validation</text>
<text text-anchor="middle" x="413" y="-935.88" font-family="Times,serif" font-size="14.00">(APF.BUNDLE_VALIDATE)</text>
</g>
<!-- C&#45;&gt;D -->
<g id="edge4" class="edge">
<title>C&#45;&gt;D</title>
<path fill="none" stroke="black" d="M434.08,-1003.03C430.92,-994.78 427.1,-984.83 423.58,-975.67"/>
<polygon fill="black" stroke="black" points="426.79,-974.25 419.94,-966.17 420.25,-976.76 426.79,-974.25"/>
</g>
<!-- F -->
<g id="node5" class="node">
<title>F</title>
<polygon fill="none" stroke="black" points="480,-877.08 338,-877.08 338,-839.08 480,-839.08 480,-877.08"/>
<text text-anchor="middle" x="409" y="-861.88" font-family="Times,serif" font-size="14.00">F: Plan Diff</text>
<text text-anchor="middle" x="409" y="-846.88" font-family="Times,serif" font-size="14.00">(APF.PLAN_DIFF)</text>
</g>
<!-- D&#45;&gt;F -->
<g id="edge5" class="edge">
<title>D&#45;&gt;F</title>
<path fill="none" stroke="black" d="M412.17,-928.05C411.63,-916.27 410.91,-900.64 410.29,-887.23"/>
<polygon fill="black" stroke="black" points="413.78,-886.91 409.83,-877.08 406.79,-887.23 413.78,-886.91"/>
<text text-anchor="middle" x="429.5" y="-898.88" font-family="Times,serif" font-size="14.00">valid</text>
</g>
<!-- D&#45;&gt;E -->
<g id="edge6" class="edge">
<title>D&#45;&gt;E</title>
<path fill="none" stroke="black" d="M436.83,-927.9C452.85,-914.9 473.74,-896.36 489,-877.08 531.58,-823.27 567.32,-751.45 586.89,-708.36"/>
<polygon fill="black" stroke="black" points="590.15,-709.65 591.05,-699.09 583.76,-706.78 590.15,-709.65"/>
<text text-anchor="middle" x="560.5" y="-809.88" font-family="Times,serif" font-size="14.00">invalid</text>
</g>
<!-- G -->
<g id="node6" class="node">
<title>G</title>
<polygon fill="none" stroke="black" points="510.5,-788.08 303.5,-788.08 303.5,-750.08 510.5,-750.08 510.5,-788.08"/>
<text text-anchor="middle" x="407" y="-772.88" font-family="Times,serif" font-size="14.00">G: Dry&#45;run / Preview</text>
<text text-anchor="middle" x="407" y="-757.88" font-family="Times,serif" font-size="14.00">(APF.DRY_RUN_PREVIEW)</text>
</g>
<!-- F&#45;&gt;G -->
<g id="edge7" class="edge">
<title>F&#45;&gt;G</title>
<path fill="none" stroke="black" d="M408.59,-839.05C408.31,-827.27 407.96,-811.64 407.65,-798.23"/>
<polygon fill="black" stroke="black" points="411.14,-798 407.41,-788.08 404.14,-798.16 411.14,-798"/>
</g>
<!-- H -->
<g id="node7" class="node">
<title>H</title>
<polygon fill="none" stroke="black" points="422,-688.99 170,-688.99 170,-650.99 422,-650.99 422,-688.99"/>
<text text-anchor="middle" x="296" y="-673.79" font-family="Times,serif" font-size="14.00">H: Safeguards / Snapshot</text>
<text text-anchor="middle" x="296" y="-658.79" font-family="Times,serif" font-size="14.00">(APF.SAFEGUARDS_SNAPSHOT)</text>
</g>
<!-- G&#45;&gt;H -->
<g id="edge8" class="edge">
<title>G&#45;&gt;H</title>
<path fill="none" stroke="black" d="M386.38,-750.04C368.97,-734.81 343.85,-712.85 324.51,-695.93"/>
<polygon fill="black" stroke="black" points="326.72,-693.21 316.88,-689.26 322.11,-698.48 326.72,-693.21"/>
<text text-anchor="middle" x="373.5" y="-720.88" font-family="Times,serif" font-size="14.00">ok</text>
</g>
<!-- G&#45;&gt;E -->
<g id="edge9" class="edge">
<title>G&#45;&gt;E</title>
<path fill="none" stroke="black" d="M426.93,-749.97C439.45,-739.3 456.35,-726.16 473,-717.08 484.48,-710.82 496.97,-705.13 509.52,-700.06"/>
<polygon fill="black" stroke="black" points="511.08,-703.21 519.12,-696.3 508.53,-696.69 511.08,-703.21"/>
<text text-anchor="middle" x="499" y="-720.88" font-family="Times,serif" font-size="14.00">conflict</text>
</g>
<!-- I -->
<g id="node8" class="node">
<title>I</title>
<polygon fill="none" stroke="black" points="522.5,-603.91 349.5,-603.91 349.5,-565.91 522.5,-565.91 522.5,-603.91"/>
<text text-anchor="middle" x="436" y="-588.71" font-family="Times,serif" font-size="14.00">I: Apply Updates</text>
<text text-anchor="middle" x="436" y="-573.71" font-family="Times,serif" font-size="14.00">(APF.APPLY_UPDATE)</text>
</g>
<!-- H&#45;&gt;I -->
<g id="edge10" class="edge">
<title>H&#45;&gt;I</title>
<path fill="none" stroke="black" d="M326.38,-650.96C346.88,-638.8 374.13,-622.62 396.34,-609.45"/>
<polygon fill="black" stroke="black" points="398.38,-612.3 405.2,-604.19 394.81,-606.28 398.38,-612.3"/>
</g>
<!-- J -->
<g id="node9" class="node">
<title>J</title>
<polygon fill="none" stroke="black" points="607,-528.91 425,-528.91 425,-490.91 607,-490.91 607,-528.91"/>
<text text-anchor="middle" x="516" y="-513.71" font-family="Times,serif" font-size="14.00">J: Verify Health</text>
<text text-anchor="middle" x="516" y="-498.71" font-family="Times,serif" font-size="14.00">(APF.VERIFY_HEALTH)</text>
</g>
<!-- I&#45;&gt;J -->
<g id="edge11" class="edge">
<title>I&#45;&gt;J</title>
<path fill="none" stroke="black" d="M455.78,-565.86C465.68,-556.83 477.83,-545.74 488.61,-535.9"/>
<polygon fill="black" stroke="black" points="491.15,-538.32 496.17,-529 486.43,-533.15 491.15,-538.32"/>
</g>
<!-- K -->
<g id="node10" class="node">
<title>K</title>
<polygon fill="none" stroke="black" points="608.5,-128.74 447.5,-128.74 447.5,-90.74 608.5,-90.74 608.5,-128.74"/>
<text text-anchor="middle" x="528" y="-113.54" font-family="Times,serif" font-size="14.00">K: Commit &amp; Log</text>
<text text-anchor="middle" x="528" y="-98.54" font-family="Times,serif" font-size="14.00">(APF.COMMIT_LOG)</text>
</g>
<!-- J&#45;&gt;K -->
<g id="edge12" class="edge">
<title>J&#45;&gt;K</title>
<path fill="none" stroke="black" d="M516,-490.66C516,-471.14 516,-439.3 516,-411.82 516,-411.82 516,-411.82 516,-202.74 516,-181.2 519.28,-157.05 522.4,-138.9"/>
<polygon fill="black" stroke="black" points="525.86,-139.44 524.2,-128.98 518.98,-138.19 525.86,-139.44"/>
<text text-anchor="middle" x="532.5" y="-308.04" font-family="Times,serif" font-size="14.00">pass</text>
</g>
<!-- R -->
<g id="node13" class="node">
<title>R</title>
<polygon fill="none" stroke="black" points="877.7,-398.74 877.7,-422.91 780.05,-439.99 641.95,-439.99 544.3,-422.91 544.3,-398.74 641.95,-381.66 780.05,-381.66 877.7,-398.74"/>
<text text-anchor="middle" x="711" y="-414.62" font-family="Times,serif" font-size="14.00">Rollback from Snapshot</text>
<text text-anchor="middle" x="711" y="-399.62" font-family="Times,serif" font-size="14.00">(APF.ROLLBACK_RESTORE)</text>
</g>
<!-- J&#45;&gt;R -->
<g id="edge14" class="edge">
<title>J&#45;&gt;R</title>
<path fill="none" stroke="black" d="M552.22,-490.87C578.29,-477.9 614.17,-460.03 645.24,-444.56"/>
<polygon fill="black" stroke="black" points="646.89,-447.65 654.28,-440.06 643.77,-441.39 646.89,-447.65"/>
<text text-anchor="middle" x="624.5" y="-461.71" font-family="Times,serif" font-size="14.00">fail</text>
</g>
<!-- L -->
<g id="node11" class="node">
<title>L</title>
<ellipse fill="none" stroke="black" cx="387" cy="-26.87" rx="128.89" ry="26.74"/>
<text text-anchor="middle" x="387" y="-30.67" font-family="Times,serif" font-size="14.00">Done: Success</text>
<text text-anchor="middle" x="387" y="-15.67" font-family="Times,serif" font-size="14.00">(APF.DONE_SUCCESS)</text>
</g>
<!-- K&#45;&gt;L -->
<g id="edge13" class="edge">
<title>K&#45;&gt;L</title>
<path fill="none" stroke="black" d="M496.36,-90.59C479.25,-80.78 457.7,-68.42 438.26,-57.27"/>
<polygon fill="black" stroke="black" points="439.92,-54.19 429.5,-52.25 436.43,-60.26 439.92,-54.19"/>
</g>
<!-- LRB -->
<g id="node17" class="node">
<title>LRB</title>
<ellipse fill="none" stroke="black" cx="669" cy="-26.87" rx="135.11" ry="26.74"/>
<text text-anchor="middle" x="669" y="-30.67" font-family="Times,serif" font-size="14.00">Done: Rolled Back</text>
<text text-anchor="middle" x="669" y="-15.67" font-family="Times,serif" font-size="14.00">(APF.DONE_ROLLBACK)</text>
</g>
<!-- K&#45;&gt;LRB -->
<g id="edge22" class="edge">
<title>K&#45;&gt;LRB</title>
<path fill="none" stroke="black" d="M559.64,-90.59C576.68,-80.82 598.13,-68.52 617.5,-57.41"/>
<polygon fill="black" stroke="black" points="619.3,-60.41 626.23,-52.4 615.82,-54.34 619.3,-60.41"/>
</g>
<!-- SHC -->
<g id="node14" class="node">
<title>SHC</title>
<polygon fill="none" stroke="black" points="1093,-330.74 617,-330.74 617,-326.74 613,-326.74 613,-322.74 617,-322.74 617,-300.74 613,-300.74 613,-296.74 617,-296.74 617,-292.74 1093,-292.74 1093,-330.74"/>
<polyline fill="none" stroke="black" points="617,-326.74 621,-326.74 621,-322.74 617,-322.74 "/>
<polyline fill="none" stroke="black" points="617,-300.74 621,-300.74 621,-296.74 617,-296.74 "/>
<text text-anchor="middle" x="855" y="-315.54" font-family="Times,serif" font-size="14.00">Self&#45;Healing Controller</text>
<text text-anchor="middle" x="855" y="-300.54" font-family="Times,serif" font-size="14.00">(APF.FAIL_CLASSIFY â†’ FIX_PLAN â†’ FIX_APPLY â†’ REVALIDATE)</text>
</g>
<!-- E&#45;&gt;SHC -->
<g id="edge16" class="edge">
<title>E&#45;&gt;SHC</title>
<path fill="none" stroke="black" d="M748.29,-654.6C826.05,-642.71 906,-621.77 906,-585.91 906,-585.91 906,-585.91 906,-409.82 906,-381.97 905.65,-373.02 892,-348.74 889.92,-345.05 887.35,-341.49 884.54,-338.15"/>
<polygon fill="black" stroke="black" points="887.04,-335.7 877.67,-330.77 881.92,-340.47 887.04,-335.7"/>
<text text-anchor="middle" x="970" y="-506.21" font-family="Times,serif" font-size="14.00">auto&#45;start healing</text>
</g>
<!-- R&#45;&gt;SHC -->
<g id="edge15" class="edge">
<title>R&#45;&gt;SHC</title>
<path fill="none" stroke="black" d="M740.9,-381.66C753.38,-370.66 768.36,-358.41 783,-348.74 790.04,-344.09 797.77,-339.63 805.46,-335.53"/>
<polygon fill="black" stroke="black" points="807.16,-338.6 814.44,-330.9 803.94,-332.38 807.16,-338.6"/>
<text text-anchor="middle" x="837.5" y="-352.54" font-family="Times,serif" font-size="14.00">â†’ classify &amp; fix</text>
</g>
<!-- RES -->
<g id="node15" class="node">
<title>RES</title>
<polygon fill="none" stroke="black" points="254,-221.74 148.09,-203.74 254,-185.74 359.91,-203.74 254,-221.74"/>
<text text-anchor="middle" x="254" y="-200.04" font-family="Times,serif" font-size="14.00">Resume Point</text>
</g>
<!-- SHC&#45;&gt;RES -->
<g id="edge17" class="edge">
<title>SHC&#45;&gt;RES</title>
<path fill="none" stroke="black" d="M752.71,-292.7C626.37,-270.42 415.65,-233.25 313.34,-215.21"/>
<polygon fill="black" stroke="black" points="313.65,-211.71 303.19,-213.42 312.43,-218.6 313.65,-211.71"/>
<text text-anchor="middle" x="718.5" y="-263.54" font-family="Times,serif" font-size="14.00">revalidate clean? yes</text>
</g>
<!-- Q -->
<g id="node16" class="node">
<title>Q</title>
<polygon fill="none" stroke="black" points="1265.58,-241.74 691.98,-241.74 544.42,-165.74 1118.02,-165.74 1265.58,-241.74"/>
<text text-anchor="middle" x="905" y="-207.54" font-family="Times,serif" font-size="14.00">Quarantine + Ticket + Notify</text>
<text text-anchor="middle" x="905" y="-192.54" font-family="Times,serif" font-size="14.00">(APF.QUARANTINE / OPEN_TICKET / NOTIFY)</text>
</g>
<!-- SHC&#45;&gt;Q -->
<g id="edge20" class="edge">
<title>SHC&#45;&gt;Q</title>
<path fill="none" stroke="black" d="M863.71,-292.28C869.08,-280.89 876.23,-265.74 883.06,-251.24"/>
<polygon fill="black" stroke="black" points="886.39,-252.4 887.49,-241.86 880.06,-249.41 886.39,-252.4"/>
<text text-anchor="middle" x="991.5" y="-263.54" font-family="Times,serif" font-size="14.00">hard&#45;fail or attempts exhausted</text>
</g>
<!-- RES&#45;&gt;D -->
<g id="edge18" class="edge">
<title>RES&#45;&gt;D</title>
<path fill="none" stroke="black" d="M165.52,-206.73C92.22,-213.67 0,-237.03 0,-310.74 0,-859.08 0,-859.08 0,-859.08 0,-920.81 178.95,-938.97 301.26,-944.17"/>
<polygon fill="black" stroke="black" points="301.31,-947.67 311.44,-944.58 301.59,-940.68 301.31,-947.67"/>
<text text-anchor="middle" x="113" y="-581.21" font-family="Times,serif" font-size="14.00">if fail&#45;fast origin â†’ resume here</text>
</g>
<!-- RES&#45;&gt;H -->
<g id="edge19" class="edge">
<title>RES&#45;&gt;H</title>
<path fill="none" stroke="black" d="M254,-222C254,-242.98 254,-279.46 254,-310.74 254,-585.91 254,-585.91 254,-585.91 254,-606.31 264.21,-626.79 274.56,-642.31"/>
<polygon fill="black" stroke="black" points="271.97,-644.7 280.6,-650.84 277.68,-640.66 271.97,-644.7"/>
<text text-anchor="middle" x="377.5" y="-461.71" font-family="Times,serif" font-size="14.00">if post&#45;apply origin â†’ resume here</text>
</g>
<!-- Q&#45;&gt;K -->
<g id="edge21" class="edge">
<title>Q&#45;&gt;K</title>
<path fill="none" stroke="black" d="M753.29,-165.72C704.99,-153.93 653.33,-141.33 611.68,-131.16"/>
<polygon fill="black" stroke="black" points="612.41,-127.74 601.87,-128.77 610.75,-134.54 612.41,-127.74"/>
</g>
</g>
</svg>
