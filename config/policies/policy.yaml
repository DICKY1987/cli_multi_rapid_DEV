# CLI Multi-Rapid Enterprise Policy Configuration
version: '1.0'
name: enterprise_policies

# Enhanced lint policies
lint:
  pre_commit_required: true
  hooks_required:
    - black
    - ruff
    - mypy
    - bandit
    - yamllint
    - markdownlint
  max_line_length: 88
  enforce_type_hints: true

# Testing policies
testing:
  coverage_min: 0.85
  test_timeout_seconds: 300
  integration_tests_required: true
  security_tests_required: true

# Enhanced security policies
security:
  deny_patterns:
    - 'DROP TABLE'
    - 'eval('
    - 'os.system('
    - 'subprocess.call('
    - 'shell=True'
    - 'import os'
    - '__import__'

  allowed_imports:
    - 'pathlib'
    - 'typing'
    - 'dataclasses'
    - 'fastapi'
    - 'pydantic'

  secret_scanning:
    enabled: true
    block_on_secrets: true

  vulnerability_scanning:
    enabled: true
    block_critical: true
    block_high: true

# Resource limits
resources:
  max_execution_time: 300
  max_memory_mb: 2048
  max_disk_mb: 1024
  max_concurrent_tasks: 5

# Quality gates
quality:
  code_complexity_max: 10
  duplicate_code_threshold: 0.1
  maintainability_min: 7.0
  documentation_required: true

# Compliance requirements
compliance:
  license_check: true
  dependency_audit: true
  artifact_signing: false  # Optional for development
  provenance_required: false  # Optional for development

# Environment overrides
environments:
  development:
    resources:
      max_execution_time: 600
    security:
      secret_scanning:
        block_on_secrets: false

  production:
    compliance:
      artifact_signing: true
      provenance_required: true
    security:
      vulnerability_scanning:
        block_medium: true
